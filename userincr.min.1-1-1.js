(function(e){e.fn.userincr=function(c){c=e.extend({},e.fn.userincr.defaults,c||{});return this.each(function(){var b=e(this),g=b.val();b.attr("title",b.attr("title")||'Enter "+x" or "+x%" or "*x" \nto change increment').data("step",b.data("step")||1).data("op",b.data("op")||"add");b.on("change",function(a){a=b.val();"%"==a.substr(-1)?(a=parseFloat(a.substr(0,a.length-1)),0<a?d("mul",1+a/100,"inc"):d("mul",1/(1+a/100),"dec")):"-"===a.substr(0,1)&&0<=b.data("min")?d("add",-parseFloat(a),"dec"):"+"==
a.substr(0,1)?(a=parseFloat(a.substr(1)),0>a?d("add",-a,"dec"):d("add",a,"inc")):"*"==a.substr(0,1)?(a=parseFloat(a.substr(1)),1<a?d("mul",a,"inc"):d("mul",1/a,"dec")):"/"==a.substr(0,1)?(a=parseFloat(a.substr(1)),1<a?d("mul",a,"dec"):d("mul",1/a,"inc")):f[1].focus();h();g=b.val()});var h=function(){var a=b.data("min");parseFloat(b.val())<a&&b.val(a);a=b.data("max");parseFloat(b.val())>a&&b.val(a)},d=function(a,c,d){b.data("op",a).data("step",c);k();l(d)},l=function(a){b.val(m[b.data("op")][a](parseFloat(g),
b.data("step")));h();f["dec"===a?0:1].focus();g=b.val();b.trigger("spin")},f=e.map(["dec","inc"],function(a){return e("<input>",{type:"button",value:c.buttonlabels[a],"class":"userincr-btn-"+a}).on("click",function(){l(a)})}),k=function(){["dec","inc"].forEach(function(a,c){f[c].attr({title:m[b.data("op")][a+"fmt"](b.data("step"))})})};k();1!=b.parent().children().length&&b.wrap('<span class="userincr-container">');b.parent().append(f)})};var m={add:{inc:function(c,b){return c+b},incfmt:function(c){return"+"+
c},dec:function(c,b){return c-b},decfmt:function(c){return"\u2212"+c}},mul:{inc:function(c,b){return c*b},incfmt:function(c){return"\u00d7"+c},dec:function(c,b){return c/b},decfmt:function(c){return"\u00f7"+c}}};e.fn.userincr.defaults={buttonlabels:{dec:"\u25bc",inc:"\u25b2"}}})(jQuery);
